## Problem
Crear **Chromatic Quest**, un juego web de pintar por números con temática de fantasía/magia, donde las imágenes se generan dinámicamente usando Gemini API y se convierten automáticamente a formato "paint by numbers".

## Essential Information

### Decisiones del Usuario
- **Plataforma**: Web (navegador)
- **Generación de imágenes**: Gemini API (Nano Banana / Nano Banana Pro)
- **Mecánica**: Con desafíos (contrarreloj, precisión, niveles progresivos)
- **Persistencia**: LocalStorage (sin backend)
- **API Key**: El usuario ya tiene una API key de Gemini
- **Nombre del juego**: Chromatic Quest

### Stack Técnico
- React 19.x + TypeScript 5.x
- Vite 7.x como bundler
- Tailwind CSS 4.x para estilos
- HTML5 Canvas API para renderizado
- @google/genai SDK para Gemini API

### Fase 1 Completada: Núcleo del Juego
**Archivos:**
- `src/types/index.ts` - Tipos TypeScript
- `src/utils/colorQuantizer.ts` - K-means clustering con espacio LAB
- `src/utils/regionDetector.ts` - Flood-fill, detección de regiones
- `src/hooks/useCanvas.ts` - Hook para manejo del canvas
- `src/components/Canvas/GameCanvas.tsx` - Componente de canvas interactivo
- `src/components/ColorPalette/ColorPalette.tsx` - Paleta de colores numerada
- `src/App.tsx` - Integración completa con UI

### Fase 2 Completada: Integración Gemini API
**Archivos creados:**
- `src/services/gemini.ts` - Cliente Gemini con retry y exponential backoff
- `src/services/imageProcessor.ts` - Pipeline: base64 → ImageData → PaintByNumbers
- `src/services/storage.ts` - Caché en localStorage
- `src/config/prompts.ts` - Prompts por categoría
- `src/hooks/useImageGeneration.ts` - Hook para generación de imágenes
- `.env.example` - Ejemplo de configuración de API key

### Fase 3 Completada: Sistema de Juego (pendiente validación)
**Archivos creados:**
- `src/services/scoring.ts` - Cálculo de puntuación, combos, estrellas
- `src/hooks/useTimer.ts` - Timer con pause/resume, penalización, visibilidad
- `src/hooks/useGameState.ts` - Estado del juego con useReducer
- `src/components/Timer/Timer.tsx` - Display MM:SS con colores críticos
- `src/components/ScoreBoard/ScoreBoard.tsx` - Puntuación en vivo, combo, accuracy
- `src/components/GameOverModal/GameOverModal.tsx` - Modal con estrellas y desglose

**Archivos modificados:**
- `src/types/index.ts` - +GameMode, GameStatus, ScoreData, GameConfig, PaintAction, campos en GameState
- `src/components/Canvas/GameCanvas.tsx` - +feedback visual ✓/✗, overlay pausa, disabled prop
- `src/App.tsx` - Flujo menu→playing, integración timer/score/modes

**Funcionalidades Fase 3:**
- 3 Modos de juego: Combined, Timed, Precision
- Timer con countdown, pause/resume, penalización -5s por error, pausa automática al cambiar tab
- Sistema de combos: x1 (1-2), x1.5 (3-5), x2 (6-9), x3 (10+)
- Puntuación: Base + time bonus + accuracy bonus + combo
- Estrellas: 3 (>95%), 2 (>75%), 1 (>50%)
- Feedback visual: ✓ verde / ✗ rojo al pintar
- Dificultad por colores: Easy 5min (5-8), Medium 4min (8-12), Hard 3min (12-16), Expert 2min (16-20)

### Estado del Build
- Build exitoso sin errores
- Lint pasando sin warnings
- Dev server: http://localhost:5173/

### Fases del Proyecto (beads)
| ID | Fase | Estado |
|-----|------|--------|
| `lores-land-1am` | Fase 1: Núcleo del Juego | Closed |
| `lores-land-e9d` | Fase 2: Integración Gemini | Closed |
| `lores-land-p1a` | Fase 3: Sistema de Juego | In Progress (completada, pendiente validación) |
| `lores-land-c8k` | Fase 4: Niveles y Progresión | Blocked by Fase 3 |
| `lores-land-dql` | Fase 5: UX y Polish | Blocked by Fase 4 |

### Reglas del Usuario
- **No tocar archivos de checkpoint** (prohibido modificarlos o crearlos por cuenta propia)
- **Esperar validación del usuario** después de completar cada fase antes de continuar
- **No hacer commits** sin aprobación del usuario

### Proyecto
- Ruta: `/Users/mabrax/Documents/playground/lores-land/chromatic-quest/`
