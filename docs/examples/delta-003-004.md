# Delta: chk-004.md vs chk-003.md

## New Section: Fase 3 Completada

**Archivos creados:**
- `src/services/scoring.ts` - Cálculo de puntuación, combos, estrellas
- `src/hooks/useTimer.ts` - Timer con pause/resume, penalización, visibilidad
- `src/hooks/useGameState.ts` - Estado del juego con useReducer
- `src/components/Timer/Timer.tsx` - Display MM:SS con colores críticos
- `src/components/ScoreBoard/ScoreBoard.tsx` - Puntuación en vivo, combo, accuracy
- `src/components/GameOverModal/GameOverModal.tsx` - Modal con estrellas y desglose

**Archivos modificados:**
- `src/types/index.ts` - +GameMode, GameStatus, ScoreData, GameConfig, PaintAction, campos en GameState
- `src/components/Canvas/GameCanvas.tsx` - +feedback visual ✓/✗, overlay pausa, disabled prop
- `src/App.tsx` - Flujo menu→playing, integración timer/score/modes

**Funcionalidades implementadas:**
- 3 Modos de juego: Combined, Timed, Precision
- Timer con countdown, pause/resume, penalización -5s por error, pausa automática al cambiar tab
- Sistema de combos: x1 (1-2), x1.5 (3-5), x2 (6-9), x3 (10+)
- Puntuación: Base + time bonus + accuracy bonus + combo
- Estrellas: 3 (>95%), 2 (>75%), 1 (>50%)
- Feedback visual: ✓ verde / ✗ rojo al pintar
- Dificultad por colores: Easy 5min (5-8), Medium 4min (8-12), Hard 3min (12-16), Expert 2min (16-20)

## Fase 2 Simplificada

Detalles técnicos removidos (ya implementados en código):
- `src/services/gemini.ts` - Removido "(máx 3 intentos)"
- `src/services/storage.ts` - Removido "(máx 10 imágenes, expiran en 24h)"
- `src/config/prompts.ts` - Removido "(creatures, landscapes, objects, characters)"

## Sección Removida: Configuración de API Key

La sección de instrucciones de configuración fue removida del checkpoint (ya documentada anteriormente).

## Status Changes
| Fase | chk-003 | chk-004 |
|------|---------|---------|
| Fase 2 | In Progress (completada, pendiente validación) | **Closed** |
| Fase 3 | Blocked by Fase 2 | **In Progress (completada, pendiente validación)** |

## Reglas Actualizadas
| Regla | chk-003 | chk-004 |
|-------|---------|---------|
| Checkpoints | "No tocar el archivo checkpoint (chk-002.md está prohibido modificarlo)" | "No tocar **archivos** de checkpoint (prohibido modificarlos **o crearlos por cuenta propia**)" |

---

**Resumen:** El checkpoint 4 documenta la **implementación completada de la Fase 3 (Sistema de Juego)**, añadiendo 6 nuevos archivos para scoring, timer, game state y componentes UI, modificando 3 archivos existentes para integrar feedback visual y modos de juego. Se marca la Fase 2 como cerrada y la Fase 3 queda pendiente de validación. Se reforzó la regla de checkpoints para incluir la prohibición de crearlos.
