## Problem
Crear **Chromatic Quest**, un juego web de pintar por números con temática de fantasía/magia, donde las imágenes se generan dinámicamente usando Gemini API y se convierten automáticamente a formato "paint by numbers".

## Essential Information

### Decisiones del Usuario
- **Plataforma**: Web (navegador)
- **Generación de imágenes**: Gemini API (Nano Banana / Nano Banana Pro)
- **Mecánica**: Con desafíos (contrarreloj, precisión, niveles progresivos)
- **Persistencia**: LocalStorage (sin backend)
- **API Key**: El usuario ya tiene una API key de Gemini
- **Nombre del juego**: Chromatic Quest

### Stack Técnico
- React 19.x + TypeScript 5.x
- Vite 7.x como bundler
- Tailwind CSS 4.x para estilos
- HTML5 Canvas API para renderizado
- @google/genai SDK para Gemini API

### Fase 1 Completada: Núcleo del Juego
**Archivos:**
- `src/types/index.ts` - Tipos TypeScript
- `src/utils/colorQuantizer.ts` - K-means clustering con espacio LAB
- `src/utils/regionDetector.ts` - Flood-fill, detección de regiones
- `src/hooks/useCanvas.ts` - Hook para manejo del canvas
- `src/components/Canvas/GameCanvas.tsx` - Componente de canvas interactivo
- `src/components/ColorPalette/ColorPalette.tsx` - Paleta de colores numerada
- `src/App.tsx` - Integración completa con UI

### Fase 2 Completada: Integración Gemini API
**Archivos creados:**
- `src/services/gemini.ts` - Cliente Gemini con retry y exponential backoff (máx 3 intentos)
- `src/services/imageProcessor.ts` - Pipeline: base64 → ImageData → PaintByNumbers
- `src/services/storage.ts` - Caché en localStorage (máx 10 imágenes, expiran en 24h)
- `src/config/prompts.ts` - Prompts por categoría (creatures, landscapes, objects, characters)
- `src/hooks/useImageGeneration.ts` - Hook para generación de imágenes
- `src/types/index.ts` - Tipos adicionales: ImageCategory, GeneratedImage, GenerationConfig
- `.env.example` - Ejemplo de configuración de API key

**Funcionalidades Fase 2:**
- Selector de 4 categorías: Criaturas Mágicas, Paisajes Fantásticos, Objetos Mágicos, Personajes
- Botón "Generate" con estado de loading
- Integración con Gemini API (modelo gemini-2.0-flash-exp)
- Warning cuando API key no está configurada
- Prompts optimizados para estilo paint-by-numbers (flat colors, bold outlines, simple shapes)

### Configuración de API Key
1. Copiar `.env.example` a `.env.local`
2. Agregar: `VITE_GEMINI_API_KEY=tu_api_key_aqui`
3. Reiniciar el dev server

### Estado del Build
- Build exitoso sin errores
- Lint pasando sin warnings
- Dev server: http://localhost:5173/

### Fases Pendientes (beads)
| ID | Fase | Estado |
|-----|------|--------|
| `lores-land-1am` | Fase 1: Núcleo del Juego | Closed |
| `lores-land-e9d` | Fase 2: Integración Gemini | In Progress (completada, pendiente validación) |
| `lores-land-p1a` | Fase 3: Sistema de Juego | Blocked by Fase 2 |
| `lores-land-c8k` | Fase 4: Niveles y Progresión | Blocked by Fase 3 |
| `lores-land-dql` | Fase 5: UX y Polish | Blocked by Fase 4 |

### Reglas del Usuario
- **No tocar el archivo checkpoint** (chk-002.md está prohibido modificarlo)
- **Esperar validación del usuario** después de completar cada fase antes de continuar
- **No hacer commits** sin aprobación del usuario

### Proyecto
- Ruta: `/Users/mabrax/Documents/playground/lores-land/chromatic-quest/`
